# 참조 타입, JVM 메모리 영역



## 참조타입

프로그램이 하는 일은 데이터를 처리하는 것이다.

자바에서 지원하는 데이터 타입은 크게 기본 타입(원시 타입 : primitive type), 참조 타입(reference type)으로 분류된다.



기본 타입은 정수, 실수, 문자, 논리 리터럴을 저장하는 타입 (int, double, char, boolean 등등)

참조 타입은 객체(Object) 의 번지를 참조하는 타입으로 배열, 열거, 클래스, 인터페이스 타입



두 타입의 차이점은 '저장되는 값이 무엇이냐' 이다.



기본 타입의 변수는 실제 값을 변수 안에 저장하지만

참조 타입은 배열, 열거, 클래스, 인터페이스를 이용한 변수는 메모리의 번지값을 저장한다. 

(번지를 통해 객체를 참조한다는 뜻에서 참조타입)



## JVM 메모리 영역

참조 타입을 알아보기 위해 JVM 메모리 영역을 알아보고 가야 한다.

javac.exe로 JVM이 시작되면 JVM은 운영체제에서 할당받은 메모리 영역(Runtime Data Area)을 다음과 같이 세부 영역으로 구분해서 사용한다.

![JVM 메모리 구조란? (JAVA) - JVM 메모리 구조](md-images/img.png)



### Method Area (메소드 영역)

코드에서 사용되는 클래스(~.class)들을 클래스 로더로 읽어 인터페이스, 클래스와 클래스별로 필드(field) 데이터, 메소드(method) 데이터, 메소드 코드, 생성자(constructor) 코드, static 변수 등을 분류해서 저장한다.

이 영역은 JVM이 시작할 때 생성되고 모든 스레드가 공유하는 영역이다.



### Heap Area (힙 영역)

new 키워드로 생성된 객체와 배열이 생성되는 영역이다.

힙 영역에 생성된 객체와 배열은 JVM 스택 영역의 변수나 다른 객체의 필드에서 참조한다.

참조하는 변수나 필드가 없으면 의미 없는 객체가 되기 때문에 JVM은 Garbage Collector를 실행시켜 쓰레기 객체를 힙 영역에서 자동으로 제거한다.



### Stack Area (스택 영역)

각 스레드 마다 하나씩 존재하며 스레드가 시작될 때 할당된다.

JVM Stack은 메소드를 호출할때 마다 프레임(Frame)을 추가(push)하고 메소드가 종료되면 해당 프레임을 제거(pop) 하는 동작을 수행한다.



프레임 내부에는 로컬 변수 스택이 있는데, 기본 타입 변수와 참조 타입 변수가 추가 되거나 제거 된다.

변수가 이 영역에 생성되는 시점은 초기화가 될 때, 즉 최초로 변수에 값이 저장될 때이다.

변수는 선언된 블록 안에서만 스택에 존재하고 블록을 벗어나면 스택에서 제거된다.

ex)

```java
char v1 = 'A';			// 1

if(vi == 'A'){			// 2
    int v2 = 100;
    double v3 = 3.14;
}

boolean v4 =true;		// 3

/*
1번 블록 이후 2번 블록(if문)이 실행 된 후 3번 블록이 실행되었어도 int v2, double v3는 소멸되었다.
블록 내부에서 실행되었을 때 생성된 후 블록이 끝나면 소멸되었기 때문이다.
*/

```

 

**기본 타입 변수는 스택 영역에 직접 값을 가지고 있지만,**

**참조 타입 변수는 값이 아니라 힙 영역이나 메소드 영역의 객체 주소를 가진다.**

ex )

`int[] scores = {10, 20, 30};` 

스택(stack)영역															힙(heap) 영역

`scores : 5번지`															`5번지 : 10, 20, 30`



### PC Register

쓰레드가 시작될 때 생성되며, 생성될 때마다 생성되는 공간으로 쓰레드마다 하나씩 존재합니다.

쓰레드가 어떤 부분을 무슨 명령으로 실행해야 할 지에대한 기록을 하는 부분으로 현재 수행중인 JVM 명령의 주소를 갖습니다.



### Native Method Stack

자바 외 언어로 작성된 네이티브 코드를 위한 메모리 영역



## null, NullPointerException

**null = 힙 영역의 객체를 참조하지 않는다는 뜻**

null값도 초기값으로 사용할 수 있기 때문에 null로 초기화된 참조 변수는 스택 영역에 생성된다.



참조 타입 변수가 null을 가지고 있을 경우, 참조 타입 변수는 사용할 수 없다.

null 값을 가지고 잇는 참조 타입 변수를 사용하면 NullPointerException 발생



## 열거 타입

데이터 중에는 몇 가지로 한정된 값만을 갖는 경우가 흔히 있다. ex) 요일, 계절 등

열거 타입(enumeration type) : 한정된 값만을 갖는 데이터 타입

열거 타입은 몇 개의 열거 상수 (enumeration constant) 중에서 하나의 상수를 저장하는 데이터 타입



1. 열거 타입 선언

```java
// Week.java

public enum Week {
    MONDAY,TUESDAY, WEDNESDAY, THURSDAY, FRIDAY, SATURDAY, SUNDAY
}
```



2. 열거 타입 변수

```java
Week today = Week.SUNDAY;
```

